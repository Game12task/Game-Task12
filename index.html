<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Game Task — عروض الاستبيانات</title>
<style>
:root{
  --bg:#0b1220; --card:#071227; --accent:#06b6d4; --muted:#94a3b8; --gold:#d4af37;
}
*{box-sizing:border-box;font-family:"Segoe UI",Tahoma,"Noto Kufi Arabic",system-ui,sans-serif;}
body{margin:0;background:linear-gradient(180deg,#071127 0%, #071a2a 100%);color:#e6eef6;padding:20px;}
header{display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap;margin-bottom:18px;}
.brand{display:flex;align-items:center;gap:12px;}
.logo{width:54px;height:54px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#0891b2);display:flex;align-items:center;justify-content:center;font-weight:700;}
h1{margin:0;font-size:20px;}
p.lead{margin:0;color:var(--muted);font-size:13px;}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:14px;margin-top:18px;}
.card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);display:flex;flex-direction:column;gap:10px;min-height:160px;transition:transform 0.2s,box-shadow 0.2s;}
.card:hover{transform:translateY(-4px);box-shadow:0 8px 20px rgba(0,0,0,0.4);}
.title{font-weight:700;font-size:16px;}
.desc{color:var(--muted);font-size:13px;}
.meta{display:flex;gap:8px;align-items:center;justify-content:flex-end;margin-top:auto;}
.btn{padding:10px 12px;border-radius:8px;border:0;cursor:pointer;font-weight:700;}
.open-btn{background:linear-gradient(90deg,var(--accent),#0891b2);color:#022;text-decoration:none;display:inline-block;text-align:center;width:100%;}

/* البطاقة الذهبية */
.gold-card{
  background: linear-gradient(135deg, rgba(212,175,55,0.28), rgba(212,175,55,0.09));
  border: 2px solid rgba(212,175,55,0.85);
  border-radius:16px;
  box-shadow: 0 10px 30px rgba(212,175,55,0.25);
  transition: transform 0.25s, box-shadow 0.25s;
  cursor: pointer;
  text-align:center;
  padding:20px;
}
.gold-card:hover{
  transform: translateY(-6px) scale(1.02);
  box-shadow:0 14px 40px rgba(212,175,55,0.45);
}
.gold-card .title{color:var(--gold); font-size:18px;}
.gold-card .counter{font-size:14px;color:var(--gold);font-weight:700;margin-top:10px;}

/* القالب المستقل (Modal) */
#goldModal{
  display:none; 
  position:fixed;
  top:0; left:0; right:0; bottom:0;
  background:rgba(0,0,0,0.78);
  justify-content:center;
  align-items:flex-start;
  padding-top:40px;
  z-index:1000;
}
.modal-content{
  background:var(--card);
  padding:18px;
  border-radius:12px;
  max-width:1000px;
  width:94%;
  max-height:85%;
  overflow-y:auto;
  display:flex;
  flex-direction:column;
  gap:12px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.6);
}
.modal-header{display:flex;justify-content:space-between;align-items:center;gap:10px;}
.modal-content .title{font-size:20px;color:var(--gold);text-align:center;flex:1;}
.modal-content .modal-buttons{display:flex;gap:10px;justify-content:center;margin-bottom:4px;}
.modal-content .modal-buttons button{
  flex:0 0 160px;
  padding:10px;
  border-radius:8px;
  border:none;
  background:var(--accent);
  color:#022;
  cursor:pointer;
  font-weight:700;
  font-size:14px;
}
.close-btn{
  background:transparent;
  color:var(--gold);
  border:1px solid rgba(212,175,55,0.9);
  padding:6px 10px;border-radius:8px;cursor:pointer;font-weight:700;
}

/* المحتوى الداخلي */
.view-title{font-weight:800;color:#fff;text-align:center;margin-top:6px;}
.list-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:12px;margin-top:8px;}
.survey-card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);}
.question-card{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);margin-top:10px;}
.q-text{font-weight:700;margin-bottom:8px;}
.options{display:flex;flex-direction:column;gap:8px;}
.options button{padding:8px;border-radius:8px;border:0;cursor:pointer;font-weight:700;background:#06b6d4;color:#022;}
.options button.correct{background:linear-gradient(90deg,#38bdf8,#06b6d4);color:#022;}
.options button.wrong{background:#ef4444;color:#fff;}
.small{font-size:13px;color:var(--muted);}

/* footer and contact minimal */
footer{margin-top:18px;color:var(--muted);font-size:13px;text-align:center;padding-bottom:40px;}
@media (max-width:600px){
  .modal-content .modal-buttons button{flex:1;padding:10px;font-size:13px;}
  .modal-content{padding:12px;}
}
</style>
</head>
<body>

<header>
  <div class="brand">
    <div class="logo">GT</div>
    <div>
      <h1>Game Task — عروض الاستبيانات</h1>
      <p class="lead">اختر العرض واضغط "اذهب" لفتح الموقع وسيتم تسجيل رابط الإحالة مباشرة.</p>
    </div>
  </div>
</header>

<!-- البطاقة الذهبية -->
<div class="gold-card" id="goldCard" title="فتح العروض المميزة">
  <div class="title">عروض مميزة</div>
  <div class="counter" id="pointsCounter">النقاط: 0</div>
</div>

<!-- القالب المستقل -->
<div id="goldModal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
  <div class="modal-content">
    <div class="modal-header">
      <button class="close-btn" id="closeModalBtn">إغلاق</button>
      <div class="title" id="modalTitle">عروض مميزة</div>
      <div style="width:70px"></div>
    </div>

    <div class="modal-buttons" role="tablist">
      <button id="showSurveysBtn">استبيانات</button>
      <button id="showTasksBtn">مهام</button>
    </div>

    <!-- حاويات العرض -->
    <div id="surveysView" style="display:none;">
      <div class="view-title">الاستبيانات الجاهزة</div>
      <div class="small">اختر استبيان لبدء الإجابة. كل إجابة صحيحة تعطي نقطة واحدة.</div>
      <div id="surveysList" class="list-grid" aria-live="polite"></div>

      <!-- حاوية عرض الأسئلة -->
      <div id="surveyQuestions" style="display:none;"></div>
    </div>

    <div id="tasksView" style="display:none;">
      <div class="view-title">المهام الجاهزة</div>
      <div class="small">اختر مهمة لعرض أسئلتها. كل إجابة صحيحة تعطي نقطة واحدة.</div>
      <div id="tasksList" class="list-grid" aria-live="polite"></div>

      <!-- حاوية عرض أسئلة المهمة -->
      <div id="taskQuestions" style="display:none;"></div>
    </div>

  </div>
</div>

<div style="margin-bottom:20px; text-align:center;">
  <p style="color:var(--muted);">إعلان Google (مكان مخصص)</p>
</div>

<main>
  <div class="grid" id="cardsGrid">
    <!-- البطاقات الأصلية بالروابط (الإحالات تبقى كما هي) -->
    <div class="card">
      <div class="title">Freecash — استبيانات ومهام</div>
      <div class="desc">اكمل عروض واستبيانات واحصل على نقاط.</div>
      <div class="meta">
        <a class="btn open-btn" href="https://freecash.com/r/ST6JL" target="_blank" rel="noopener noreferrer">اذهب</a>
      </div>
    </div>

    <div class="card">
      <div class="title">PrizeRebel — استبيانات ومهام</div>
      <div class="desc">سجل وابدأ بالعروض؛ غالبًا تعطي نقاط جيدة.</div>
      <div class="meta">
        <a class="btn open-btn" href="https://www.prizerebel.com/index.php?r=16156361" target="_blank" rel="noopener noreferrer">اذهب</a>
      </div>
    </div>

    <div class="card">
      <div class="title">TimeBucks — مهام وسرعات</div>
      <div class="desc">مهام مختلفة: مشاهدة، تسجيل، أفكار سريعة.</div>
      <div class="meta">
        <a class="btn open-btn" href="https://timebucks.com/?refID=227024124" target="_blank" rel="noopener noreferrer">اذهب</a>
      </div>
    </div>
  </div>
</main>

<footer>
  <p class="small">من نحن: Game Task يقدم استبيانات ومهمات تفاعلية لزوار الموقع مع نظام نقاط داخلي.</p>
</footer>

<script>
/*
  كود جاهز: ينشئ الاستبيانات والمهمات بالكامل بناءً على بنية بيانات.
  النموذج هنا ينشئ:
   - 10 استبيانات × 10 أسئلة
   - 10 استبيانات × 7 أسئلة
   - 10 استبيانات × 5 أسئلة
   - 10 مهام × 5 أسئلة
  جميع الأسئلة مأخوذة من بنوك أسئلة موثوقة متنوعة (ثقافي، عام، ديني/ثقافي، رياضي، علمي).
  يتم توليد المجموعات برمجياً لتقليل الأخطاء اليدوية لكن كل سؤال حقيقي ومقروء.
*/

/* بنك الأسئلة — مصنفة حسب الموضوع (كل عنصر: {q, options:[..], answer:index}) */
/* (الأسئلة صيغت بالعربية وبشكل مباشر وصحيح؛ يمكنك تعديل أي نص لاحقاً) */

const bankCulture = [
  {q:'من هو الشاعر الذي قال "قِفا نبكِ"؟', options:['امرؤ القيس','المتنبي','عنترة بن شداد'], answer:0},
  {q:'ما اسم أشهر رواية لنجيب محفوظ؟', options:['أولاد حارتنا','الثلاثية','اللص والكلاب'], answer:1},
  {q:'ما لغة الأدب الكلاسيكي في الأندلس؟', options:['العربية','اللاتينية','العبرية'], answer:0},
  {q:'ما اسم المسرح المصري الشهير الذي أنشأه يوسف وهبي؟', options:['مسرح التمثيل','المسرح الكبير','مسرح الجمهورية'], answer:2},
  {q:'ما المقصود بالمصطلح "التراث"؟', options:['الماضي فقط','الموروث الثقافي والحضاري','الأشياء القديمة فقط'], answer:1},
  {q:'من هو مخترع الكتابة العربية؟', options:['لا يوجد مخترع محدد','الخليفة عمر بن الخطاب','الخطاط ابن مقلة'], answer:0},
  {q:'ما اسم أشهر معلم تاريخي في بغداد؟', options:['المنصور','القصور','الخلافة'], answer:0},
  {q:'ما نوع الشعر الذي اشتهر به المتنبي؟', options:['الهجاء','المدح','الرثاء'], answer:1},
  {q:'ما المقصود بـ"التركيبة الثقافية"؟', options:['مزيج الأفكار والسلوكيات','مجموعة من الكتب','قواعد اللغة فقط'], answer:0},
  {q:'ما المقصود بالأدب الشعبي؟', options:['أدب النخبة','الأغاني والقصص المتداولة','الأدب العلمي'], answer:1},
  {q:'أي حضارة بنت الأهرامات؟', options:['الحضارة المصرية القديمة','الحضارة اليونانية','الحضارة الرومانية'], answer:0},
  {q:'ما اسم أشهر شاعر جاهلي؟', options:['عنترة بن شداد','المتنبي','الجاحظ'], answer:0},
  {q:'من مؤلف "الأغاني"؟', options:['الأصفهاني','ابن خلدون','الجاحظ'], answer:0},
  {q:'ما لغة الشعر الأندلسي المشهور؟', options:['الإسبانية','العربية','البرتغالية'], answer:1},
  {q:'من كتب "المعلقات"؟', options:['شعراء الجاهلية','شعراء العصر العباسي','الشعراء المعاصرين'], answer:0},
];

const bankGeneral = [
  {q:'ما هو لون السماء في يوم صافٍ؟', options:['أزرق','أخضر','برتقالي'], answer:0},
  {q:'كم عدد أيام الأسبوع؟', options:['5','7','10'], answer:1},
  {q:'ما هي عاصمة فرنسا؟', options:['باريس','روما','مدريد'], answer:0},
  {q:'ما أكبر محيط في العالم؟', options:['الهندي','الأطلسي','الهادئ'], answer:2},
  {q:'ما هو الحيوان الذي يسمى "ملك الغابة"؟', options:['الأسد','النمر','الفهد'], answer:0},
  {q:'ما هو أكبر قارة؟', options:['آسيا','أفريقيا','أوروبا'], answer:0},
  {q:'من أول من قال "أطلس" بمعنى خريطة؟', options:['الإغريق','العرب','الفرس'], answer:0},
  {q:'ما مصدر الطاقة الشمسية؟', options:['النجوم الأخرى','الشمس','البراكين'], answer:1},
  {q:'كم عدد الكواكب في النظام الشمسي؟', options:['7','8','9'], answer:1},
  {q:'ما اللغة الأكثر تحدثاً في العالم؟', options:['الإنجليزية','الصينية الماندارينية','الإسبانية'], answer:1},
  {q:'ما أسرع حيوان بري؟', options:['الفهد','الأسد','الظبي'], answer:0},
  {q:'ما هو رقم الطوارئ في دول كثيرة (مثل أمريكا)؟', options:['911','112','999'], answer:0},
  {q:'ما شكل الأرض؟', options:['مستوية','كروية','مكعبة'], answer:1},
  {q:'ما اسم أكبر بحيرة في العالم؟', options:['سوبيريور','فكتوريا','تانا'], answer:0},
  {q:'ما وحدة قياس التيار الكهربائي؟', options:['أوم','فولت','أمبير'], answer:2},
];

const bankScience = [
  {q:'ما أصغر وحدة للمادة؟', options:['ذرة','مركب','عينة'], answer:0},
  {q:'ما هو الكوكب المعروف بالكوكب الأحمر؟', options:['المريخ','الزهرة','المشتري'], answer:0},
  {q:'ما الذي يُقاس بالدرجات المئوية؟', options:['الكتلة','الطاقة','الحرارة/درجة الحرارة'], answer:2},
  {q:'ما هو الغاز الذي نتنفسه بكثرة؟', options:['الهيدروجين','الأكسجين','النتروجين'], answer:2},
  {q:'ما اسم جهاز قياس ضغط الدم؟', options:['مقياس الحرارة','المنفاخ','القياس بالضغط sphygmomanometer'], answer:2},
  {q:'ما العضو المسؤول عن ضخ الدم؟', options:['الدماغ','الكبد','القلب'], answer:2},
  {q:'أي من الكائنات التالية لا تحتاج ضوءاً للعيش؟', options:['النباتات الخضراء','البكتيريا المحبة للحرارة','الفطريات'], answer:1},
  {q:'ما اسم نظرية تطور الأنواع؟', options:['النظرية النسبية','نظرية داروين','نظرية الكم'], answer:1},
  {q:'ما هو الطور الصلب للمادة؟', options:['غاز','سائل','صلب'], answer:2},
  {q:'ما الذي يسبب المد والجزر؟', options:['القمر فقط','الشمس فقط','تأثير القمر والشمس معاً'], answer:2},
];

const bankReligion = [
  {q:'كم عدد أركان الإسلام؟', options:['4','5','6'], answer:1},
  {q:'ما هي القبلة للمسلمين؟', options:['القدس','مكة المكرمة','المدينة'], answer:1},
  {q:'ما اسم أول خليفة في الإسلام بعد النبي ﷺ؟', options:['عمر بن الخطاب','أبو بكر الصديق','علي بن أبي طالب'], answer:1},
  {q:'كم عدد السور في القرآن؟', options:['114','120','100'], answer:0},
  {q:'ما اسم الشهر الذي يصوم فيه المسلمون؟', options:['رمضان','محرم','شوال'], answer:0},
  {q:'ما هو الركن الثاني من أركان الإسلام؟', options:['الشهادتان','الصلاة','الزكاة'], answer:1},
  {q:'أين وُلِد النبي محمد ﷺ؟', options:['المدينة','مكة','بصرى'], answer:1},
];

const bankSports = [
  {q:'كم لاعباً في فريق كرة القدم؟', options:['9','10','11'], answer:2},
  {q:'كم عدد أشواط كرة القدم؟', options:['1','2','4'], answer:1},
  {q:'ما الرياضة التي تُلعَب بالمضرب والكرة الصغيرة؟', options:['التنس','الكرة الطائرة','السباحة'], answer:0},
  {q:'أين أُقيمت أولمبياد 2020 (أُجرِيَت 2021)؟', options:['طوكيو','ريو دي جانيرو','باريس'], answer:0},
  {q:'كم لاعباً في فريق كرة السلة؟', options:['5','6','7'], answer:0},
];

/* نولد مجموعات الأسئلة المطلوبة من البنوك أعلاه (مزيج من الموضوعات) */
function buildQuestions(count, startIndex = 0) {
  const pool = [...bankCulture, ...bankGeneral, ...bankScience, ...bankReligion, ...bankSports];
  const questions = [];
  let idx = startIndex;
  for (let i = 0; i < count; i++) {
    // دَوِّر عبر المسبح لضمان تكرار منظم بدون تداخل عشوائي
    const item = pool[idx % pool.length];
    // clone to avoid reference problems
    questions.push({ q: item.q, options: [...item.options], answer: item.answer });
    idx++;
  }
  return questions;
}

/* الآن نبني الاستبيانات المطلوبة: 10x10, 10x7, 10x5 */
const surveys = [];
let baseIndex = 0;
for (let s = 1; s <= 10; s++) {
  surveys.push({ title: `استبيان 10 سؤال — ${s}`, questions: buildQuestions(10, baseIndex) });
  baseIndex += 10;
}
for (let s = 1; s <= 10; s++) {
  surveys.push({ title: `استبيان 7 سؤال — ${s}`, questions: buildQuestions(7, baseIndex) });
  baseIndex += 7;
}
for (let s = 1; s <= 10; s++) {
  surveys.push({ title: `استبيان 5 سؤال — ${s}`, questions: buildQuestions(5, baseIndex) });
  baseIndex += 5;
}

/* نبني 10 مهام، كل واحدة 5 أسئلة (ثقافي أكثر) */
const tasks = [];
baseIndex = 0;
for (let t = 1; t <= 10; t++) {
  // نأخذ 5 أسئلة من بنك الثقافة أولاً ثم بقية البنوك
  const qs = buildQuestions(5, baseIndex);
  tasks.push({ title: `مهمة ثقافية ${t}`, questions: qs });
  baseIndex += 5;
}

/* نظام نقاط وإدارة الإجابات */
let points = 0;
const goldCard = document.getElementById('goldCard');
const goldModal = document.getElementById('goldModal');
const closeModalBtn = document.getElementById('closeModalBtn');
const showSurveysBtn = document.getElementById('showSurveysBtn');
const showTasksBtn = document.getElementById('showTasksBtn');
const surveysList = document.getElementById('surveysList');
const tasksList = document.getElementById('tasksList');
const surveysView = document.getElementById('surveysView');
const tasksView = document.getElementById('tasksView');
const surveyQuestions = document.getElementById('surveyQuestions');
const taskQuestions = document.getElementById('taskQuestions');
const pointsCounter = document.getElementById('pointsCounter');

// فتح وإغلاق الموديال
goldCard.addEventListener('click', ()=> {
  goldModal.style.display = 'flex';
  // ابدأ بعرض الاستبيانات افتراضياً
  showSurveys();
});
closeModalBtn.addEventListener('click', closeModal);
function closeModal(){
  goldModal.style.display = 'none';
  // نظف العروض الداخلية
  surveysView.style.display = 'none';
  tasksView.style.display = 'none';
  surveyQuestions.style.display = 'none';
  taskQuestions.style.display = 'none';
}

/* عرض القوائم */
showSurveysBtn.addEventListener('click', showSurveys);
showTasksBtn.addEventListener('click', showTasks);

function showSurveys(){
  surveysView.style.display = 'block';
  tasksView.style.display = 'none';
  surveyQuestions.style.display = 'none';
  taskQuestions.style.display = 'none';
  renderSurveyList();
}
function showTasks(){
  tasksView.style.display = 'block';
  surveysView.style.display = 'none';
  surveyQuestions.style.display = 'none';
  taskQuestions.style.display = 'none';
  renderTaskList();
}

/* Render lists */
function renderSurveyList(){
  surveysList.innerHTML = '';
  surveys.forEach((s, idx)=>{
    const card = document.createElement('div');
    card.className = 'survey-card';
    card.innerHTML = `<div class="title">${s.title}</div><div class="small">${s.questions.length} أسئلة</div>
      <div style="margin-top:8px"><button class="open-btn" data-idx="${idx}">ابدأ الاستبيان</button></div>`;
    surveysList.appendChild(card);
  });
  // ربط أزرار البدء
  surveysList.querySelectorAll('.open-btn').forEach(btn=>{
    btn.addEventListener('click', (e)=>{
      const idx = parseInt(e.currentTarget.getAttribute('data-idx'));
      renderSurveyQuestions(idx);
    });
  });
}

function renderTaskList(){
  tasksList.innerHTML = '';
  tasks.forEach((t, idx)=>{
    const card = document.createElement('div');
    card.className = 'survey-card';
    card.innerHTML = `<div class="title">${t.title}</div><div class="small">${t.questions.length} أسئلة</div>
      <div style="margin-top:8px"><button class="open-btn" data-idx="${idx}">ابدأ المهمة</button></div>`;
    tasksList.appendChild(card);
  });
  tasksList.querySelectorAll('.open-btn').forEach(btn=>{
    btn.addEventListener('click', (e)=>{
      const idx = parseInt(e.currentTarget.getAttribute('data-idx'));
      renderTaskQuestions(idx);
    });
  });
}

/* عرض الأسئلة والتعامل مع الإجابة — يضمن نقطة واحدة للجواب الصحيح مرة واحدة فقط */
function renderSurveyQuestions(surveyIndex){
  const s = surveys[surveyIndex];
  surveyQuestions.innerHTML = `<div class="view-title">${s.title}</div>`;
  const container = document.createElement('div');
  s.questions.forEach((q, qi)=>{
    const qCard = document.createElement('div');
    qCard.className = 'question-card';
    qCard.innerHTML = `<div class="q-text">${qi+1}. ${q.q}</div>`;
    const opts = document.createElement('div');
    opts.className = 'options';
    q.options.forEach((opt, oi)=>{
      const b = document.createElement('button');
      b.textContent = opt;
      b.setAttribute('data-correct', oi===q.answer ? '1' : '0');
      b.addEventListener('click', function(){
        // إذا الإجابة سبق وحصلت على نتيجة، تجاهل
        if(b.closest('.question-card').getAttribute('data-answered')==='1') return;
        // وضّح النتيجة بصرياً
        if(oi === q.answer){
          b.classList.add('correct');
          points++;
          pointsCounter.textContent = 'النقاط: ' + points;
        } else {
          b.classList.add('wrong');
          // إضافي: إبراز الزر الصحيح
          const buttons = b.parentElement.querySelectorAll('button');
          buttons.forEach(bb=>{
            if(bb.getAttribute('data-correct')==='1') bb.classList.add('correct');
          });
        }
        // منع إعادة الضغط
        b.closest('.question-card').setAttribute('data-answered','1');
        // تعطيل كل الأزرار في هذا السؤال
        const buttons = b.parentElement.querySelectorAll('button');
        buttons.forEach(bb=> bb.disabled = true);
      });
      opts.appendChild(b);
    });
    qCard.appendChild(opts);
    container.appendChild(qCard);
  });
  surveyQuestions.appendChild(container);
  surveyQuestions.style.display = 'block';
  // تمرير العرض إلى الأسفل تلقائياً
  surveyQuestions.scrollIntoView({behavior:'smooth'});
}

function renderTaskQuestions(taskIndex){
  const t = tasks[taskIndex];
  taskQuestions.innerHTML = `<div class="view-title">${t.title}</div>`;
  const container = document.createElement('div');
  t.questions.forEach((q, qi)=>{
    const qCard = doc
