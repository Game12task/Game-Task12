<?php
// Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ø¨Ø³ÙŠØ· ÙˆÙ…Ø¤Ù‚Øª. ÙŠÙ‚ÙˆÙ… Ø¨ØªØ³Ø¬ÙŠÙ„ ÙƒÙ„ Ø¹Ù…Ù„ÙŠØ© Postback ÙÙŠ Ù…Ù„Ù Ù†ØµÙŠ (postback_log.txt)
// Ù„Ø§Ø­Ù‚Ø§Ù‹ØŒ Ø³ÙŠØªÙ… ØªØ¹Ø¯ÙŠÙ„Ù‡ Ù„ÙŠØ±Ø¨Ø· Ø¨Ù€ Firebase ÙˆÙŠØ¶ÙŠÙ Ø§Ù„Ø±ØµÙŠØ¯ ÙØ¹Ù„Ø§Ù‹.

// 1. Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø© Ù…Ù† CPAGrip
// user_id Ø³ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ø§Ù„Ù€ userID)
$user_id = isset($_GET['user_id']) ? $_GET['user_id'] : 'UNKNOWN';
// amount Ø³ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± Ø§Ù„Ù…ÙƒØªØ³Ø¨Ø© ({payout})
$amount = isset($_GET['amount']) ? $_GET['amount'] : 0;

// 2. Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ù„Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„
$log_file = 'postback_log.txt'; // Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø³ÙŠØ±ÙØ±Ùƒ
$timestamp = date('Y-m-d H:i:s');

// 3. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (ØªØ£ÙƒÙŠØ¯ Ø£Ù† Ø§Ù„Ù…Ø¨Ù„Øº Ø±Ù‚Ù… ÙˆØ£Ù† Ù‡Ù†Ø§Ùƒ Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù…)
if (is_numeric($amount) && $amount > 0 && $user_id !== 'UNKNOWN') {
    
    // ðŸ’¡ Ù…Ù„Ø§Ø­Ø¸Ø© Ù‡Ø§Ù…Ø©: Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ø°ÙŠ Ø³Ù†Ø¶Ø¹ ÙÙŠÙ‡ ÙƒÙˆØ¯ Firebase Ù„Ø§Ø­Ù‚Ø§Ù‹
    // ... Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠ Ù„Ø¥Ø¶Ø§ÙØ© $amount Ø¥Ù„Ù‰ Ø­Ø³Ø§Ø¨ $user_id ÙÙŠ Firebase ...
    
    // Ø­Ø§Ù„ÙŠØ§Ù‹ØŒ Ù†Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© ÙƒÙ†Ø¬Ø§Ø­
    $log_message = "$timestamp | SUCCESS | User: $user_id | Amount: $amount USD\n";
    
    // 4. Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… 1 Ù„Ù€ CPAGrip Ù„ØªØ£ÙƒÙŠØ¯ Ø£Ù† Ø§Ù„ÙÙ„ÙˆØ³ ÙˆØµÙ„Øª ÙˆØªÙ… ØªØ³Ø¬ÙŠÙ„Ù‡Ø§
    echo 1;
} else {
    // ÙØ´Ù„ ÙÙŠ Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ­ÙŠØ­Ø© Ø£Ùˆ Ø§Ù„Ù…Ø¨Ù„Øº ØµÙØ±
    $log_message = "$timestamp | FAILURE | Missing or Invalid Data. User ID: $user_id, Amount: $amount\n";
    
    // 5. Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… 0 Ù„Ù€ CPAGrip ÙŠÙÙŠØ¯ Ø¨ÙØ´Ù„ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…
    echo 0;
}

// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙÙŠ Ù…Ù„Ù Ø§Ù„Ù€ Log Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
// FILE_APPEND ÙŠØ¹Ù†ÙŠ Ø£Ù† Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ØªÙØ¶Ø§Ù ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ù„Ù
file_put_contents($log_file, $log_message, FILE_APPEND);

?>
