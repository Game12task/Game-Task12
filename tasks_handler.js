// tasks_handler.js - Ù…Ù„Ù Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ© (ØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡ Ù„Ø¯Ø¹Ù… ØªØµÙÙŠØ© Ø§Ù„ÙØ¦Ø§Øª)

// -----------------------------------------------------
// 1. Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ© (5 Ø£Ø³Ø¦Ù„Ø© Ù„ÙƒÙ„ ÙŠÙˆÙ…)
// -----------------------------------------------------

// Ø§Ù„Ù…Ù‡Ø§Ù… Ù„ÙŠÙˆÙ… Ø§Ù„Ø£Ø­Ø¯ØŒ Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡ØŒ Ø§Ù„Ø®Ù…ÙŠØ³ (Day 1)
const DAILY_TASKS_DAY1 = [
    // Ø§Ù„Ù…Ù‡Ù…Ø© 1: Ø¯ÙŠÙ†ÙŠØ©
    {
        ID: 'T1-D01',
        category: 'Religious',
        question: 'Ù…Ù† Ù‡Ùˆ Ø£ÙˆÙ„ Ø§Ù„Ø®Ù„ÙØ§Ø¡ Ø§Ù„Ø±Ø§Ø´Ø¯ÙŠÙ†ØŸ',
        options: ['Ø¹Ù…Ø± Ø¨Ù† Ø§Ù„Ø®Ø·Ø§Ø¨', 'Ø¹Ù„ÙŠ Ø¨Ù† Ø£Ø¨ÙŠ Ø·Ø§Ù„Ø¨', 'Ø£Ø¨Ùˆ Ø¨ÙƒØ± Ø§Ù„ØµØ¯ÙŠÙ‚', 'Ø¹Ø«Ù…Ø§Ù† Ø¨Ù† Ø¹ÙØ§Ù†'],
        correctAnswer: 'Ø£Ø¨Ùˆ Ø¨ÙƒØ± Ø§Ù„ØµØ¯ÙŠÙ‚',
        points: 5 
    },
    // Ø§Ù„Ù…Ù‡Ù…Ø© 2: Ø«Ù‚Ø§ÙÙŠØ©
    {
        ID: 'T1-C02',
        category: 'Cultural',
        question: 'Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø£ÙˆÙ„ Ø¹Ù…Ù„Ø© Ø±Ù‚Ù…ÙŠØ© Ù…Ø´Ù‡ÙˆØ±Ø© ØºÙŠØ± Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ† ØªÙ… Ø¥ØµØ¯Ø§Ø±Ù‡Ø§ØŸ',
        options: ['Ø§Ù„Ù„Ø§ÙŠØªÙƒÙˆÙŠÙ† (Litecoin)', 'Ø§Ù„Ø¥ÙŠØ«ÙŠØ±ÙŠÙˆÙ… (Ethereum)', 'Ø§Ù„Ø±ÙŠØ¨Ù„ (Ripple)', 'Ù„Ù… ØªØ¸Ù‡Ø± Ø¨Ø¹Ø¯'],
        correctAnswer: 'Ø§Ù„Ù„Ø§ÙŠØªÙƒÙˆÙŠÙ† (Litecoin)',
        points: 5
    },
    // Ø§Ù„Ù…Ù‡Ù…Ø© 3: Ø±ÙŠØ§Ø¶ÙŠØ©
    {
        ID: 'T1-S03',
        category: 'Sports',
        question: 'Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ø¯ÙˆÙ„Ø© Ø§Ù„ØªÙŠ ÙØ§Ø²Øª Ø¨Ø£ÙˆÙ„ ÙƒØ£Ø³ Ø¹Ø§Ù„Ù… Ù„ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù… Ø¹Ø§Ù… 1930ØŸ',
        options: ['Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„', 'Ø§Ù„Ø£Ø±Ø¬Ù†ØªÙŠÙ†', 'Ø£ÙˆØ±ÙˆØºÙˆØ§ÙŠ', 'Ø¥ÙŠØ·Ø§Ù„ÙŠØ§'],
        correctAnswer: 'Ø£ÙˆØ±ÙˆØºÙˆØ§ÙŠ',
        points: 5
    },
    // Ø§Ù„Ù…Ù‡Ù…Ø© 4: ØªØ§Ø±ÙŠØ®ÙŠØ©
    {
        ID: 'T1-H04',
        category: 'Historical',
        question: 'ÙÙŠ Ø£ÙŠ Ø¹Ø§Ù… Ø³Ù‚Ø· Ø¬Ø¯Ø§Ø± Ø¨Ø±Ù„ÙŠÙ†ØŸ',
        options: ['1991', '1989', '1985', '1995'],
        correctAnswer: '1989',
        points: 5
    },
     // Ø§Ù„Ù…Ù‡Ù…Ø© 5: Ø¹Ù„Ù…ÙŠØ©/ØªÙ‚Ù†ÙŠØ©
    {
        ID: 'T1-Sc05',
        category: 'Scientific/Technological',
        question: 'Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠ Ø§Ù„Ø°ÙŠ ÙŠØ±Ù…Ø² Ù„Ù‡ Ø¨Ø§Ù„Ø±Ù…Ø² AuØŸ',
        options: ['Ø§Ù„ÙØ¶Ø©', 'Ø§Ù„Ù†Ø­Ø§Ø³', 'Ø§Ù„Ø°Ù‡Ø¨', 'Ø§Ù„Ø­Ø¯ÙŠØ¯'],
        correctAnswer: 'Ø§Ù„Ø°Ù‡Ø¨',
        points: 5
    }
];

// Ø§Ù„Ù…Ù‡Ø§Ù… Ù„ÙŠÙˆÙ… Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†ØŒ Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡ØŒ Ø§Ù„Ø¬Ù…Ø¹Ø© (Day 2)
const DAILY_TASKS_DAY2 = [
    // Ø§Ù„Ù…Ù‡Ù…Ø© 1: Ø¯ÙŠÙ†ÙŠØ©
    {
        ID: 'T2-D01',
        category: 'Religious',
        question: 'ÙÙŠ Ø£ÙŠ Ø´Ù‡Ø± Ù‡Ø¬Ø±ÙŠ ØªÙ… ÙØ±Ø¶ Ø§Ù„ØµÙŠØ§Ù…ØŸ',
        options: ['Ø±Ø¬Ø¨', 'Ø´ÙˆØ§Ù„', 'Ø±Ù…Ø¶Ø§Ù†', 'Ø°Ùˆ Ø§Ù„Ø­Ø¬Ø©'],
        correctAnswer: 'Ø±Ù…Ø¶Ø§Ù†',
        points: 5
    },
    // Ø§Ù„Ù…Ù‡Ù…Ø© 2: Ø«Ù‚Ø§ÙÙŠØ©
    {
        ID: 'T2-C02',
        category: 'Cultural',
        question: 'Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ù‚Ø§Ø±Ø© Ø§Ù„ØªÙŠ ÙŠÙ…Ø± Ø¨Ù‡Ø§ Ø®Ø· Ø§Ù„Ø§Ø³ØªÙˆØ§Ø¡ ÙˆÙ…Ø¯Ø§Ø± Ø§Ù„Ø¬Ø¯ÙŠ ÙˆÙ…Ø¯Ø§Ø± Ø§Ù„Ø³Ø±Ø·Ø§Ù† Ù…Ø¹Ø§Ù‹ØŸ',
        options: ['Ø¢Ø³ÙŠØ§', 'Ø£ÙØ±ÙŠÙ‚ÙŠØ§', 'Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©', 'Ø£Ø³ØªØ±Ø§Ù„ÙŠØ§'],
        correctAnswer: 'Ø£ÙØ±ÙŠÙ‚ÙŠØ§',
        points: 5
    },
    // Ø§Ù„Ù…Ù‡Ù…Ø© 3: Ø±ÙŠØ§Ø¶ÙŠØ©
    {
        ID: 'T2-S03',
        category: 'Sports',
        question: 'ÙƒÙ… Ø¹Ø¯Ø¯ Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ø¹Ù„Ù… Ø§Ù„Ø£ÙˆÙ„Ù…Ø¨ÙŠ (Ø§Ù„ØªÙŠ ØªÙ…Ø«Ù„ Ø§Ù„Ù‚Ø§Ø±Ø§Øª)ØŸ',
        options: ['4', '5', '6', '7'],
        correctAnswer: '5',
        points: 5
    },
    // Ø§Ù„Ù…Ù‡Ù…Ø© 4: ØªØ§Ø±ÙŠØ®ÙŠØ©
    {
        ID: 'T2-H04',
        category: 'Historical',
        question: 'Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù‚Ø¯ÙŠÙ… Ù„Ù…Ø¯ÙŠÙ†Ø© Ø¥Ø³Ø·Ù†Ø¨ÙˆÙ„ØŸ',
        options: ['Ø£Ù†Ù‚Ø±Ø©', 'Ø§Ù„Ù‚Ø³Ø·Ù†Ø·ÙŠÙ†ÙŠØ©', 'Ø±ÙˆÙ…Ø§', 'Ø£Ø«ÙŠÙ†Ø§'],
        correctAnswer: 'Ø§Ù„Ù‚Ø³Ø·Ù†Ø·ÙŠÙ†ÙŠØ©',
        points: 5
    },
     // Ø§Ù„Ù…Ù‡Ù…Ø© 5: Ø¹Ù„Ù…ÙŠØ©/ØªÙ‚Ù†ÙŠØ©
    {
        ID: 'T2-Sc05',
        category: 'Scientific/Technological',
        question: 'Ù…Ø§ Ù‡Ùˆ Ø§Ù„ØºØ§Ø² Ø§Ù„Ø£ÙƒØ«Ø± ÙˆÙØ±Ø© ÙÙŠ Ø§Ù„ØºÙ„Ø§Ù Ø§Ù„Ø¬ÙˆÙŠ Ù„Ù„Ø£Ø±Ø¶ØŸ',
        options: ['Ø§Ù„Ø£ÙƒØ³Ø¬ÙŠÙ†', 'Ø«Ø§Ù†ÙŠ Ø£ÙƒØ³ÙŠØ¯ Ø§Ù„ÙƒØ±Ø¨ÙˆÙ†', 'Ø§Ù„Ù†ÙŠØªØ±ÙˆØ¬ÙŠÙ†', 'Ø§Ù„Ù‡ÙŠØ¯Ø±ÙˆØ¬ÙŠÙ†'],
        correctAnswer: 'Ø§Ù„Ù†ÙŠØªØ±ÙˆØ¬ÙŠÙ†',
        points: 5
    }
];


// -----------------------------------------------------
// 2. Ø¯Ø§Ù„Ø© Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù‡Ø§Ù… Ù„Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ (Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØ¯ÙˆÙŠØ± ÙˆØ§Ù„ØªØµÙÙŠØ©)
// -----------------------------------------------------
function getCurrentDailyTasks(category = null) { // ğŸ’¡ ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…ØªØºÙŠØ± category
    const today = new Date();
    const dayOfWeek = today.getDay(); 
    // ÙŠÙˆÙ… 0 Ù‡Ùˆ Ø§Ù„Ø£Ø­Ø¯ØŒ ÙŠÙˆÙ… 1 Ù‡Ùˆ Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†
    const isDayOne = (dayOfWeek === 0 || dayOfWeek === 2 || dayOfWeek === 4); 

    const allTasks = isDayOne ? DAILY_TASKS_DAY1 : DAILY_TASKS_DAY2;

    // Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… ØªÙ…Ø±ÙŠØ± ÙØ¦Ø©ØŒ Ù†Ø±Ø¬Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù… (5 Ø£Ø³Ø¦Ù„Ø©).
    if (!category) {
        return allTasks;
    }
    
    // Ø¥Ø°Ø§ ØªÙ… ØªØ­Ø¯ÙŠØ¯ ÙØ¦Ø©ØŒ Ù†Ø±Ø¬Ø¹ Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„ØªÙŠ ØªØ·Ø§Ø¨Ù‚ Ø§Ù„ÙØ¦Ø© ÙÙ‚Ø· (Ø³Ø¤Ø§Ù„ ÙˆØ§Ø­Ø¯).
    return allTasks.filter(task => task.category.toLowerCase() === category.toLowerCase());
}

// -----------------------------------------------------
// 3. Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„Ù…Ù‡Ø§Ù…
// -----------------------------------------------------
function isTaskAvailable(taskId) {
    const userId = localStorage.getItem('user_id');
    // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ User IDØŒ Ø§ÙØªØ±Ø¶ Ø£Ù†Ù‡Ø§ ØºÙŠØ± Ù…ØªØ§Ø­Ø© (Ø£Ùˆ Ø¹Ø¯Ù‘Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø´Ø±Ø· Ø¥Ø°Ø§ ÙƒÙ†Øª Ù„Ø§ ØªØ­ØªØ§Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„)
    if (!userId) return false; 
    
    const completionKey = `task_completed_${userId}_${taskId}`;
    const lastCompletionDate = localStorage.getItem(completionKey);
    
    const today = new Date().toDateString(); 
    
    return lastCompletionDate !== today;
}

// -----------------------------------------------------
// 4. Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù…Ù‡Ù…Ø©
// -----------------------------------------------------
function markTaskCompleted(taskId) {
    const userId = localStorage.getItem('user_id');
    if (!userId) return;

    const completionKey = `task_completed_${userId}_${taskId}`;
    const today = new Date().toDateString();
    localStorage.setItem(completionKey, today);
}
